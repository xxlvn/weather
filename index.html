<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–ü–æ–≥–æ–¥–∞ –≤ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–µ</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0d1117">
<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('service-worker.js')
        .then(() => console.log('‚úÖ Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω'))
        .catch(err => console.error('‚ùå –û—à–∏–±–∫–∞ Service Worker:', err));
    });
  }
</script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> <!-- –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" /> <!-- –¥–ª—è –∫–∞—Ä—Ç—ã -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <link rel="icon" href="img/weather-icon.png" type="image/x-icon">
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <h1>–ü–æ–≥–æ–¥–∞ –≤ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–µ</h1>

    <!-- –ø–æ–∏—Å–∫ –≥–æ—Ä–æ–¥–∞ -->
    <div class="search">
      <input type="text" id="cityInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –≥–æ—Ä–æ–¥" />
      <button id="showWeatherBtn">–ü–æ–∫–∞–∑–∞—Ç—å</button>
    </div>

    <!-- –ª–æ–∞–¥–µ—Ä -->
    <div id="loader" class="loader hidden">
      <div class="spinner"></div>
      <p>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</p>
    </div>

    <!-- –∫–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –¥–Ω–µ–π -->
    <div class="day-nav" id="dayNav"></div>

    <!-- —Ç–∞–±–ª–∏—Ü–∞ —Å –ø–æ–≥–æ–¥–æ–π -->
    <table id="weatherTable" class="hidden fade">
      <thead>
        <tr>
          <th>–ü–µ—Ä–∏–æ–¥</th>
          <th>–ü–æ–≥–æ–¥–∞</th>
          <th>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞</th>
          <th>–û—â—É—â–∞–µ—Ç—Å—è –∫–∞–∫</th>
          <th>–û—Å–∞–¥–∫–∏</th>
          <th>–î–∞–≤–ª–µ–Ω–∏–µ</th>
          <th>–í–µ—Ç–µ—Ä</th>
          <th>–í–ª–∞–∂–Ω–æ—Å—Ç—å</th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>

    <!-- –±–ª–æ–∫ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π -->
    <div class="info" id="extraInfo"></div>

    <!-- –∫–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ -->
    <div class="chart-toggle">
      <button id="tempChartBtn" class="active">–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞</button>
      <button id="feelsChartBtn">–û—â—É—â–∞–µ—Ç—Å—è</button>
    </div>

    <button id="installBtn" class="install-btn hidden">üì≤ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</button>

<script>
const installBtn = document.getElementById("installBtn");
let deferredPrompt;

// –ü—Ä–æ–≤–µ—Ä–∫–∞: –º–æ–±–∏–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ?
const isMobile = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);

if (isMobile) {
  // –î–ª—è Android (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç beforeinstallprompt)
  window.addEventListener("beforeinstallprompt", (e) => {
    e.preventDefault();
    deferredPrompt = e;
    installBtn.classList.remove("hidden");

    installBtn.addEventListener("click", () => {
      installBtn.classList.add("hidden");
      deferredPrompt.prompt();
      deferredPrompt.userChoice.then((choiceResult) => {
        if (choiceResult.outcome === "accepted") {
          console.log("‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞");
        } else {
          console.log("‚ùå –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞");
        }
        deferredPrompt = null;
      });
    });
  });

  // –î–ª—è iOS ‚Äî –Ω–µ—Ç beforeinstallprompt
  const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);
  const isInStandaloneMode = ("standalone" in window.navigator) && window.navigator.standalone;

  if (isIOS && !isInStandaloneMode) {
    // –ü–æ–∫–∞–∂–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    installBtn.classList.remove("hidden");
    installBtn.textContent = "üì≤ –î–æ–±–∞–≤–∏—Ç—å –Ω–∞ —ç–∫—Ä–∞–Ω";
    installBtn.addEventListener("click", () => {
      alert("–ù–∞ iPhone: –Ω–∞–∂–º–∏—Ç–µ ¬´–ü–æ–¥–µ–ª–∏—Ç—å—Å—è¬ª ‚Üí ¬´–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ —ç–∫—Ä–∞–Ω¬ª");
    });
  }
} else {
  // –ù–∞ –ü–ö –∫–Ω–æ–ø–∫—É –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º
  installBtn.remove();
}
</script>

    <!-- –∫–∞—Ä—Ç–∞ -->
    <div class="map" id="map"></div>
  </div>
  <script src="script.js"></script>
</body>
</html>
